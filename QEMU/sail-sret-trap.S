# Sail was trapping on the mret here due to missing ASR in MTCC (and therefore PCC), but QEMU wasn't
# Fixed in https://github.com/CTSRD-CHERI/qemu/commit/807f231d32bbc0bca140d98dc1517dde97697c94
#>QCVENGINE_TEST_V2.0
.4byte 0xbff00993 # addi x19, x0, -1025
#      Trap: False, PCWD: 0x0000000080000038, RD: 19, RWD: 0xfffffffffffffbff, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x00000000bff00993 PRV_M XL:64 (addi x19, x0, -1025)

.4byte 0x1b3181db # candperm x3, x3, x19
#      Trap: False, PCWD: 0x000000008000003c, RD: 03, RWD: 0x0000000000000000, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x000000001b3181db PRV_M XL:64 (candperm x3, x3, x19)

.4byte 0x03c1805b # cspecialrw x0, mtcc, x3
#      Trap: False, PCWD: 0x0000000080000040, RD: 00, RWD: 0x0000000000000000, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x0000000003c1805b PRV_M XL:64 (cspecialrw x0, mtcc, x3)

.4byte 0xfec001db # cjalr x3, x0
#      Trap:  True, PCWD: 0x0000000000000000, RD: 00, RWD: 0x0000000000000000, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x00000000fec001db PRV_M XL:64 (cjalr x3, x0)

.4byte 0x10200073 # sret
#  A < Trap:  True, PCWD: 0x0000000000000000, RD: 00, RWD: 0x0000000000000000, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x0000000030200073 PRV_M XL:64 (mret)
#  B > Trap: False, PCWD: 0x0000000080000040, RD: 00, RWD: 0x0000000000000000, MA: 0x0000000000000000, MWD: 0x0000000000000000, MWM: 0b00000000, I: 0x0000000030200073 PRV_M XL:64 (mret)

#>START_NO_SHRINK
.4byte 0x342020f3 # csrrs x1, mcause (0x342), x0
.4byte 0x343020f3 # csrrs x1, mtval (0x343), x0
.4byte 0xbc0020f3 # csrrs x1, mccsr (0xbc0), x0
#>END_NO_SHRINK

# Test end
#      halt token
